<UserControl x:Class="warkbench.Views.ContentBrowserView"
             xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converter="using:warkbench.Converter"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:dataTemplates="using:warkbench.DataTemplates"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:views="using:warkbench.Views"
             xmlns:vm="using:warkbench.ViewModels"
             x:Name="Root"
             d:DesignHeight="450"
             d:DesignWidth="800"
             x:CompileBindings="True"
             x:DataType="vm:ContentBrowserViewModel"
             mc:Ignorable="d">

    <UserControl.Resources>
        <converter:FolderIconConverter x:Key="FolderIconConverter" />
    </UserControl.Resources>

    <!--  DataTemplates  -->
    <UserControl.DataTemplates>
        <dataTemplates:FileSystemItemTemplateSelector>
            <!--  DataTemplate File  -->
            <DataTemplate x:Key="File" DataType="vm:FileViewModel">
                <Border Width="100"
                        Height="100"
                        Margin="8"
                        Padding="5"
                        Background="#393b40"
                        CornerRadius="6"
                        PointerEntered="OnPointerEntered"
                        PointerExited="OnPointerExited"
                        PointerPressed="OnPointerPressed">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="6">
                        <PathIcon Width="48"
                                  Height="48"
                                  Foreground="Gray"
                                  Data="{StaticResource icon_file_empty}" />
                        <TextBlock FontSize="12"
                                   Foreground="White"
                                   Text="{Binding Name}"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </DataTemplate>
            <!--  DataTemplate Folder  -->
            <DataTemplate x:Key="Folder" DataType="vm:FolderViewModel">
                <Border Width="100"
                        Height="100"
                        Margin="8"
                        Padding="5"
                        Background="#393b40"
                        CornerRadius="6"
                        PointerEntered="OnPointerEntered"
                        PointerExited="OnPointerExited"
                        PointerPressed="OnPointerPressed">
                    <Border.ContextMenu>
                        <ContextMenu>
                            <MenuItem Command="{Binding DataContext.MarkAsFavoriteCommand, ElementName=Root}"
                                      CommandParameter="{Binding}"
                                      Header="Mark as favorite">
                                <MenuItem.Icon>
                                    <PathIcon Width="16"
                                              Height="16"
                                              Data="{StaticResource icon_heart_plus}" />
                                </MenuItem.Icon>
                            </MenuItem>
                        </ContextMenu>
                    </Border.ContextMenu>
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="6">
                        <PathIcon Width="48"
                                  Height="48"
                                  Foreground="#ffca28"
                                  Data="{StaticResource icon_folder}" />
                        <TextBlock FontSize="12"
                                   Foreground="White"
                                   Text="{Binding Name}"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </DataTemplate>
            <!--  DataTemplate HppFile  -->
            <DataTemplate x:Key="HppFile" DataType="vm:HppFileViewModel">
                <Border Width="100"
                        Height="100"
                        Margin="8"
                        Padding="5"
                        Background="#393b40"
                        CornerRadius="6"
                        PointerEntered="OnPointerEntered"
                        PointerExited="OnPointerExited"
                        PointerPressed="OnPointerPressed">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="6">
                        <Svg Width="48"
                             Height="48"
                             HorizontalAlignment="Center"
                             Path="avares://warkbench/Assets/Icons/Files/icon_hpp_file.svg" />
                        <TextBlock FontSize="12"
                                   Foreground="White"
                                   Text="{Binding Name}"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </DataTemplate>
            <!--  DataTemplate PngFile  -->
            <DataTemplate x:Key="PngFile" DataType="vm:PngFileViewModel">
                <Border Width="100"
                        Height="100"
                        Margin="8"
                        Padding="5"
                        Background="#393b40"
                        CornerRadius="6"
                        PointerEntered="OnPointerEntered"
                        PointerExited="OnPointerExited"
                        PointerPressed="OnPointerPressed">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Spacing="6">
                        <PathIcon Width="48"
                                  Height="48"
                                  Foreground="MediumSpringGreen"
                                  Data="{StaticResource icon_file_png}" />
                        <TextBlock FontSize="12"
                                   Foreground="White"
                                   Text="{Binding Name}"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap" />
                    </StackPanel>
                </Border>
            </DataTemplate>
            
            <!--  DataTemplate ...  -->
        </dataTemplates:FileSystemItemTemplateSelector>
    </UserControl.DataTemplates>

    <!--  ==============================  -->

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="2" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Menu  -->
        <Border Grid.Row="0"
                Margin="3,3,3,0"
                Padding="6"
                Background="#191a1c">
            <StackPanel VerticalAlignment="Top" Orientation="Horizontal">
                <!--  Add Button  -->
                <Button Height="32"
                        Margin="0,0,6,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Click="OnOpenFolder">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <PathIcon Width="16"
                                  Height="16"
                                  Margin="0,0,6,0"
                                  Data="{StaticResource icon_add}"
                                  Foreground="LimeGreen" />
                        <TextBlock Text="Add" />
                    </StackPanel>
                </Button>
                <!--  Import Button  -->
                <Button Height="32"
                        Margin="0,0,6,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="Transparent">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <PathIcon Width="16"
                                  Height="16"
                                  Margin="0,0,6,0"
                                  Data="{StaticResource icon_place_item}" />
                        <TextBlock Text="Import" />
                    </StackPanel>
                </Button>
                <!--  Save All Button  -->
                <Button Height="32"
                        Margin="0,0,6,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="Transparent">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <PathIcon Width="16"
                                  Height="16"
                                  Margin="0,0,6,0"
                                  Data="{StaticResource icon_save}" />
                        <TextBlock Text="Save All" />
                    </StackPanel>
                </Button>

                <Separator Width="1"
                           Height="24"
                           Margin="0,0,6,0"
                           VerticalAlignment="Center" />

                <!--  < Button  -->
                <Button Width="32"
                        Height="32"
                        Margin="0,0,2,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="Transparent">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <PathIcon Width="16"
                                  Height="16"
                                  HorizontalAlignment="Center"
                                  Data="{StaticResource icon_arrow_circle_left}" />
                    </StackPanel>
                </Button>
                <!--  > Button  -->
                <Button Width="32"
                        Height="32"
                        Margin="0,0,6,0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="Transparent">
                    <StackPanel HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                        <PathIcon Width="16"
                                  Height="16"
                                  Data="{StaticResource icon_arrow_circle_right}" />
                    </StackPanel>
                </Button>
                <!--  BreadcrumbBar  -->
                <StackPanel Orientation="Horizontal" Spacing="1">
                    <!--  Home  -->
                    <Button Height="32"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Background="Transparent"
                            Command="{Binding HomeButtonPressedCommand}">
                        <StackPanel HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Orientation="Horizontal">
                            <PathIcon Width="16"
                                      Height="16"
                                      Data="{StaticResource icon_home}" />
                        </StackPanel>
                    </Button>
                    <!--  Breadcrumbs  -->
                    <ItemsControl x:Name="ItemsControl_Breadcrumbs" ItemsSource="{Binding BreadcrumbBar}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="vm:BreadcrumbViewModel">
                                <StackPanel VerticalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="1">
                                    <!--  >  -->
                                    <PathIcon Width="16"
                                              Height="16"
                                              VerticalAlignment="Center"
                                              Data="{StaticResource icon_arrow_forward}" />
                                    <!--  Path  -->
                                    <Button Height="32"
                                            HorizontalContentAlignment="Center"
                                            VerticalContentAlignment="Center"
                                            Background="Transparent"
                                            Command="{Binding DataContext.BreadcrumbPressedCommand, ElementName=Root}"
                                            CommandParameter="{Binding Folder}">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Orientation="Horizontal">
                                            <TextBlock Text="{Binding Folder.Name}" />
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </StackPanel>
        </Border>

        <!--  Splitter  -->
        <GridSplitter Grid.Row="1"
                      Background="Transparent"
                      IsHitTestVisible="False"
                      ResizeDirection="Rows" />

        <!--  Folder & Files  -->
        <Border Grid.Row="2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="300" />
                    <ColumnDefinition Width="2" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!--  Folder Hierachy  -->
                <Grid Grid.Column="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0">
                        <Border x:Name="Border_FolderHierachy"
                                Padding="3,3,3,0"
                                Background="#191a1c">
                            <StackPanel Spacing="4">
                                <!--  Favorites  -->
                                <Expander HorizontalAlignment="Stretch"
                                        VerticalAlignment="Top"
                                        ExpandDirection="Down"
                                        Header="Favorites">
                                    <TreeView x:Name="TreeView_Favorites"
                                            Grid.Row="0"
                                            AutoScrollToSelectedItem="True"
                                            ItemsSource="{Binding Favorites}"
                                            SelectedItem="{Binding SelectedFavoritesItem}">
                                        <TreeView.Styles>
                                            <Style Selector="TreeViewItem">
                                                <Setter Property="ContextMenu">
                                                    <ContextMenu>
                                                        <MenuItem Command="{Binding DataContext.UnmarkAsFavoriteCommand, ElementName=Root}"
                                                                CommandParameter="{Binding}"
                                                                Header="Unmark as favorite">
                                                            <MenuItem.Icon>
                                                                <PathIcon Width="16"
                                                                        Height="16"
                                                                        Data="{StaticResource icon_heart_minus}" />
                                                            </MenuItem.Icon>
                                                        </MenuItem>
                                                    </ContextMenu>
                                                </Setter>
                                            </Style>
                                        </TreeView.Styles>

                                        <TreeView.ItemTemplate>
                                            <TreeDataTemplate ItemsSource="{Binding SubFolders}">
                                                <StackPanel Orientation="Horizontal">
                                                    <PathIcon Width="16"
                                                            Height="16"
                                                            Margin="0,0,6,0"
                                                            Data="{Binding IsExpanded, Converter={StaticResource FolderIconConverter}}" />
                                                    <TextBlock Text="{Binding Name}" />
                                                </StackPanel>
                                            </TreeDataTemplate>
                                        </TreeView.ItemTemplate>
                                    </TreeView>
                                </Expander>
                                <!--  Explorer  -->
                                <Expander x:Name="Expander_Explorer"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Top"
                                        ExpandDirection="Down"
                                        Header="Explorer"
                                        IsExpanded="True">
                                    <TreeView x:Name="TreeView_Explorer"
                                            Grid.Row="0"
                                            ItemsSource="{Binding Explorer}"
                                            SelectedItem="{Binding SelectedExplorerItem}">
                                        <TreeView.Styles>
                                            <Style x:DataType="vm:FolderViewModel" Selector="TreeViewItem">
                                                <Setter Property="IsEnabled" Value="{Binding IsSelectable}" />
                                                <Setter Property="ContextMenu">
                                                    <ContextMenu>
                                                        <MenuItem Command="{Binding DataContext.MarkAsFavoriteCommand, ElementName=Root}"
                                                                CommandParameter="{Binding}"
                                                                Header="Mark as favorite">
                                                            <MenuItem.Icon>
                                                                <PathIcon Width="16"
                                                                        Height="16"
                                                                        Data="{StaticResource icon_heart_plus}" />
                                                            </MenuItem.Icon>
                                                        </MenuItem>
                                                    </ContextMenu>
                                                </Setter>
                                            </Style>
                                        </TreeView.Styles>

                                        <TreeView.ItemTemplate>
                                            <TreeDataTemplate ItemsSource="{Binding SubFolders}">
                                                <Border PointerPressed="OnPointerPressed">
                                                    <StackPanel Orientation="Horizontal">
                                                        <PathIcon Width="16"
                                                                Height="16"
                                                                Margin="0,0,6,0"
                                                                Data="{Binding IsExpanded, Converter={StaticResource FolderIconConverter}}" />
                                                        <TextBlock Text="{Binding Name}" />
                                                    </StackPanel>
                                                </Border>
                                            </TreeDataTemplate>
                                        </TreeView.ItemTemplate>
                                    </TreeView>
                                </Expander>
                            </StackPanel>
                        </Border>
                    </ScrollViewer>
                </Grid>


                <!--  Splitter  -->
                <GridSplitter Grid.Column="1"
                              Background="Transparent"
                              ResizeDirection="Columns" />

                <!--  Current Level  -->
                <Border x:Name="CurrentLevel_FolderHierachy"
                        Grid.Column="2"
                        Padding="3,3,3,0"
                        Background="#191a1c">
                    <Grid>
                        <Image Width="512"
                               Height="512"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Bottom"
                               IsHitTestVisible="False"
                               Opacity="0.2"
                               Source="avares://warkbench/Assets/Icons/App/png/warkbench_1024x1024_alpha_03.png" />

                        <ScrollViewer>
                            <ItemsControl ItemsSource="{Binding CurrentLevel}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
